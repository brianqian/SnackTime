{"ast":null,"code":"import _regeneratorRuntime from \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/src/pages/_StaffPages/AllStudentsPage/AllStudentsPage.jsx\";\nimport React, { Component } from 'react';\nimport { Redirect } from 'react-router';\nimport { Link } from 'react-router-dom';\nimport Chip from '@material-ui/core/Chip';\nimport FaceIcon from '@material-ui/icons/Face';\nimport './AllStudentsPage.css';\nimport HeaderBar from '../../../components/HeaderBar/HeaderBar';\nimport Auth from '../../../utils/Auth';\nimport Avatar from '@material-ui/core/Avatar'; // import DashboardItem from '../../components/DashboardItem/DashboardItem';\n\nvar AllStudentsPage =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(AllStudentsPage, _Component);\n\n  function AllStudentsPage() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, AllStudentsPage);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AllStudentsPage)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      name: '',\n      userId: '',\n      orgName: '',\n      orgId: '',\n      loggedIn: false,\n      loginRejected: false,\n      allStudents: [],\n      loadingMessage: \"Loading...\"\n    };\n\n    _this.getUserStudents = function () {\n      console.log(_this.state.userId);\n      fetch(\"/api/parent/parentinfo/\".concat(_this.state.userId)).then(function (resp) {\n        return resp.json();\n      }).then(function (resp) {\n        console.log(resp);\n\n        _this.setState({\n          allStudents: resp\n        });\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    };\n\n    _this.getOrgStudents = function () {\n      fetch(\"/api/student/\".concat(_this.state.orgId)).then(function (resp) {\n        return resp.json();\n      }).then(function (resp) {\n        console.log(resp);\n        if (resp.length > 0) _this.setState({\n          allStudents: resp\n        });else _this.setState({\n          loadingMessage: \"No students to display\"\n        });\n      }).catch(function (err) {\n        return console.log(err);\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(AllStudentsPage, [{\n    key: \"componentWillMount\",\n    value: function () {\n      var _componentWillMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var data;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return fetch('/auth/loggedin');\n\n              case 2:\n                _context.next = 4;\n                return _context.sent.json();\n\n              case 4:\n                data = _context.sent;\n\n                if (!(data.userType === 'staff')) {\n                  _context.next = 10;\n                  break;\n                }\n\n                _context.next = 8;\n                return Auth.StaffAuthorize(this);\n\n              case 8:\n                _context.next = 13;\n                break;\n\n              case 10:\n                _context.next = 12;\n                return Auth.ParentAuthorize(this);\n\n              case 12:\n                console.log(this.state);\n\n              case 13:\n                if (this.state.userType === 'staff') {\n                  this.getOrgStudents();\n                } else {\n                  this.getUserStudents();\n                }\n\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function componentWillMount() {\n        return _componentWillMount.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      if (this.state.loggedIn) {\n        return React.createElement(\"div\", {\n          className: \"students-container\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 66\n          },\n          __self: this\n        }, React.createElement(HeaderBar, {\n          type: this.state.userType,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 67\n          },\n          __self: this\n        }), this.state.allStudents.length > 0 ? this.state.allStudents.map(function (student) {\n          return React.createElement(Link, {\n            key: student.id,\n            to: {\n              pathname: \"/allstudentspage/\".concat(student.id),\n              state: {\n                role: _this2.state.userType\n              }\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 71\n            },\n            __self: this\n          }, React.createElement(Chip // studentId={student.id}\n          , {\n            avatar: React.createElement(Avatar, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 75\n              },\n              __self: this\n            }, React.createElement(FaceIcon, {\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 76\n              },\n              __self: this\n            })),\n            label: student.name // clickable\n            ,\n            variant: \"outlined\",\n            color: \"primary\",\n            className: \"student__item\" // image=\"/img/boy.png\"\n            // notifications={student.notifications}\n            ,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 72\n            },\n            __self: this\n          }));\n        }) : React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 89\n          },\n          __self: this\n        }, this.state.loadingMessage));\n      }\n\n      if (this.state.loginRejected) {\n        return React.createElement(Redirect, {\n          to: {\n            pathname: '/notAuthorized'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 95\n          },\n          __self: this\n        });\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return AllStudentsPage;\n}(Component);\n\nexport { AllStudentsPage as default };","map":{"version":3,"sources":["/Users/admin/Desktop/my-code/UCB/SnackTime/client/src/pages/_StaffPages/AllStudentsPage/AllStudentsPage.jsx"],"names":["React","Component","Redirect","Link","Chip","FaceIcon","HeaderBar","Auth","Avatar","AllStudentsPage","state","name","userId","orgName","orgId","loggedIn","loginRejected","allStudents","loadingMessage","getUserStudents","console","log","fetch","then","resp","json","setState","catch","err","getOrgStudents","length","data","userType","StaffAuthorize","ParentAuthorize","map","student","id","pathname","role"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Redirect } from 'react-router';\nimport { Link } from 'react-router-dom';\nimport Chip from '@material-ui/core/Chip';\nimport FaceIcon from '@material-ui/icons/Face';\nimport './AllStudentsPage.css';\nimport HeaderBar from '../../../components/HeaderBar/HeaderBar';\nimport Auth from '../../../utils/Auth';\nimport Avatar from '@material-ui/core/Avatar';\n// import DashboardItem from '../../components/DashboardItem/DashboardItem';\n\nexport default class AllStudentsPage extends Component {\n  state = {\n    name: '',\n    userId: '',\n    orgName: '',\n    orgId: '',\n    loggedIn: false,\n    loginRejected: false,\n    allStudents: [],\n    loadingMessage: \"Loading...\"\n  };\n\n  async componentWillMount() {\n    let data = await (await fetch('/auth/loggedin')).json();\n    if (data.userType === 'staff') {\n      await Auth.StaffAuthorize(this);\n    } else {\n      await Auth.ParentAuthorize(this);\n      console.log(this.state);\n    }\n    if (this.state.userType === 'staff') {\n      this.getOrgStudents();\n    } else {\n      this.getUserStudents();\n    }\n  }\n\n  getUserStudents = () => {\n    console.log(this.state.userId);\n    fetch(`/api/parent/parentinfo/${this.state.userId}`)\n      .then(resp => resp.json())\n      .then(resp => {\n        console.log(resp);\n        this.setState({ allStudents: resp })\n      })\n      .catch(err => console.log(err))\n  }\n\n  getOrgStudents = () => {\n    fetch(`/api/student/${this.state.orgId}`)\n      .then(resp => resp.json())\n      .then(resp => {\n        console.log(resp);\n        if (resp.length > 0)\n          this.setState({ allStudents: resp });\n        else\n          this.setState({ loadingMessage: \"No students to display\" });\n      })\n      .catch(err => console.log(err));\n  };\n\n  render() {\n    if (this.state.loggedIn) {\n      return (\n        <div className=\"students-container\">\n          <HeaderBar type={this.state.userType} />\n\n          {this.state.allStudents.length > 0\n            ? this.state.allStudents.map(student => (\n              <Link key={student.id} to={{ pathname: `/allstudentspage/${student.id}`, state: { role: this.state.userType } }}>\n                <Chip\n                  // studentId={student.id}\n                  avatar={\n                    <Avatar>\n                      <FaceIcon />\n                    </Avatar> \n                  }\n                  label={student.name}\n                  // clickable\n                  variant=\"outlined\"\n                  color=\"primary\"\n                  className=\"student__item\"\n                // image=\"/img/boy.png\"\n                // notifications={student.notifications}\n                />\n              </Link>\n            ))\n            : <div>{this.state.loadingMessage}</div>}\n        </div>\n      );\n    }\n    if (this.state.loginRejected) {\n      return (\n        <Redirect\n          to={{\n            pathname: '/notAuthorized'\n          }}\n        />\n      );\n    }\n    return <div />;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}