{"ast":null,"code":"import _defineProperty from \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/admin/Desktop/my-code/UCB/SnackTime/client/src/pages/_StaffPages/UpdateDailyReport/AddMeds/AddMeds.jsx\";\nimport React from 'react';\nimport PropTypes from 'prop-types'; //import classNames from 'classnames';\n\nimport { withStyles } from '@material-ui/core/styles'; //import MenuItem from '@material-ui/core/MenuItem';\n\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport HeaderBar from '../../../../components/HeaderBar/HeaderBar'; // import Label from '@material-ui/core/Label';\n// import DateTimeSelector from '../../../../components/DateTimeSelector/DateTimeSelector';\n// import { Redirect } from 'react-router-dom';\n\nimport Auth from '../../../../utils/Auth';\nimport MultiSelectContainer from '../MultiSelect/MultiSelectContainer';\nimport Timepicker from '../../../../components/TimePicker/TimePicker';\nimport './AddMeds.css';\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport { Redirect } from 'react-router-dom';\n\nvar styles = function styles(theme) {\n  return {\n    container: {\n      display: 'flex',\n      flexWrap: 'wrap'\n    },\n    submitbutton: {\n      marginTop: 25,\n      height: 10\n    },\n    textField: {\n      marginLeft: theme.spacing.unit,\n      marginRight: theme.spacing.unit,\n      width: 200\n    },\n    dense: {\n      marginTop: 19\n    },\n    menu: {\n      width: 200\n    }\n  };\n};\n\nvar AddMeds =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(AddMeds, _React$Component);\n\n  function AddMeds() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, AddMeds);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AddMeds)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      allStudents: [],\n      studentIdsToSubmit: [],\n      time: '',\n      medName: '',\n      multiline: 'Controlled',\n      snackbarMessage: 'No student selected'\n    };\n    _this.timepickerState = React.createRef();\n\n    _this.updateStudents = function (newArray) {\n      _this.setState({\n        allStudents: newArray\n      });\n    };\n\n    _this.handleSubmit =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(event) {\n        var time, idArray;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault();\n                time = _this.timepickerState.current.returnTime();\n                _context.next = 4;\n                return _this.setState({\n                  time: time\n                });\n\n              case 4:\n                idArray = [];\n\n                _this.state.allStudents.map(function (student) {\n                  if (student.selected === true) {\n                    idArray.push(student.id);\n                  }\n                });\n\n                _context.next = 8;\n                return _this.setState({\n                  studentIdsToSubmit: idArray\n                });\n\n              case 8:\n                if (_this.state.studentIdsToSubmit.length === 0) _this.handleClickSnackbar();else _this.state.studentIdsToSubmit.map(function (id) {\n                  return _this.postMeds(id);\n                });\n\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.handleChange = function (name) {\n      return function (event) {\n        _this.setState(_defineProperty({}, name, event.target.value));\n      };\n    };\n\n    _this.postMeds = function (id) {\n      var today = new Date();\n      var date = today.getFullYear() + '-' + (today.getMonth() + 1) + '-' + today.getDate();\n      console.log(date);\n      fetch(\"/api/student/\".concat(id, \"/medicine\"), {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          time: _this.state.time,\n          medName: _this.state.medName,\n          date: date\n        })\n      }).then(function (resp) {\n        console.log(resp);\n        return resp.json();\n      }).then(function (resp) {\n        console.log(\"Resp2:\", resp);\n\n        if (resp.errors) {\n          if (resp.errors.length > 0) {\n            if (resp.errors[0].message === \"Validation notEmpty on medName failed\") _this.setState({\n              snackbarMessage: \"Please write medicine name\"\n            }, _this.handleClickSnackbar());\n          }\n        } else if (resp) {\n          _this.setState({\n            snackbarMessage: \"Medication added.\"\n          }, _this.handleClickSnackbar());\n        }\n      });\n    };\n\n    _this.handleClickSnackbar = function () {\n      _this.setState({\n        open: true\n      });\n    };\n\n    _this.handleCloseSnackbar = function (event, reason) {\n      if (reason === \"clickaway\") {\n        return;\n      }\n\n      _this.setState({\n        open: false,\n        studentIdsToSubmit: [],\n        snackbarMessage: 'No student selected'\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(AddMeds, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      Auth.StaffAuthorize(this);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var classes = this.props.classes;\n\n      if (this.state.loggedIn) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 134\n          },\n          __self: this\n        }, React.createElement(HeaderBar, {\n          type: this.state.userType,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 135\n          },\n          __self: this\n        }), React.createElement(MultiSelectContainer, {\n          orgId: this.state.orgId,\n          allStudents: this.state.allStudents,\n          updateStudents: this.updateStudents,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 136\n          },\n          __self: this\n        }), React.createElement(\"div\", {\n          className: \"addmeds-container\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"addmeds-item1\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 143\n          },\n          __self: this\n        }, React.createElement(Timepicker, {\n          ref: this.timepickerState,\n          setTime: this.setMedTime,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 144\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          className: \"addmeds-item2\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146\n          },\n          __self: this\n        }, React.createElement(TextField, {\n          required: true,\n          label: \"Medicines Administered\",\n          className: classes.textField,\n          value: this.state.medName,\n          rows: \"5\",\n          onChange: this.handleChange('medName'),\n          multiline: true,\n          margin: \"normal\",\n          variant: \"outlined\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 147\n          },\n          __self: this\n        })), React.createElement(Button, {\n          className: classes.submitbutton,\n          color: \"primary\",\n          onClick: this.handleSubmit,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 160\n          },\n          __self: this\n        }, \"Add Activity\")), React.createElement(Snackbar, {\n          anchorOrigin: {\n            vertical: \"bottom\",\n            horizontal: \"left\"\n          },\n          open: this.state.open,\n          autoHideDuration: 6000,\n          onClose: this.handleCloseSnackbar,\n          ContentProps: {\n            \"aria-describedby\": \"message-id\"\n          },\n          message: React.createElement(\"span\", {\n            id: \"message-id\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 179\n            },\n            __self: this\n          }, this.state.snackbarMessage),\n          action: [React.createElement(IconButton, {\n            key: \"close\",\n            \"aria-label\": \"Close\",\n            color: \"inherit\",\n            className: classes.close,\n            onClick: this.handleCloseSnackbar,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 181\n            },\n            __self: this\n          }, React.createElement(CloseIcon, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 188\n            },\n            __self: this\n          }))],\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 168\n          },\n          __self: this\n        }));\n      } else if (this.state.loginRejected) {\n        return React.createElement(Redirect, {\n          to: {\n            pathname: \"/notAuthorized\",\n            state: {\n              type: \"Staff\",\n              location: '/dailyreport/addmeds'\n            }\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 196\n          },\n          __self: this\n        });\n      } else {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 207\n          },\n          __self: this\n        });\n      }\n    }\n  }]);\n\n  return AddMeds;\n}(React.Component);\n\nAddMeds.propTypes = {\n  classes: PropTypes.object.isRequired\n};\nexport default withStyles(styles)(AddMeds);","map":{"version":3,"sources":["/Users/admin/Desktop/my-code/UCB/SnackTime/client/src/pages/_StaffPages/UpdateDailyReport/AddMeds/AddMeds.jsx"],"names":["React","PropTypes","withStyles","TextField","Button","HeaderBar","Auth","MultiSelectContainer","Timepicker","Snackbar","IconButton","CloseIcon","Redirect","styles","theme","container","display","flexWrap","submitbutton","marginTop","height","textField","marginLeft","spacing","unit","marginRight","width","dense","menu","AddMeds","state","allStudents","studentIdsToSubmit","time","medName","multiline","snackbarMessage","timepickerState","createRef","updateStudents","newArray","setState","handleSubmit","event","preventDefault","current","returnTime","idArray","map","student","selected","push","id","length","handleClickSnackbar","postMeds","handleChange","name","target","value","today","Date","date","getFullYear","getMonth","getDate","console","log","fetch","method","headers","body","JSON","stringify","then","resp","json","errors","message","open","handleCloseSnackbar","reason","StaffAuthorize","classes","props","loggedIn","userType","orgId","setMedTime","vertical","horizontal","close","loginRejected","pathname","type","location","Component","propTypes","object","isRequired"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\n//import classNames from 'classnames';\nimport { withStyles } from '@material-ui/core/styles';\n//import MenuItem from '@material-ui/core/MenuItem';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport HeaderBar from '../../../../components/HeaderBar/HeaderBar';\n// import Label from '@material-ui/core/Label';\n// import DateTimeSelector from '../../../../components/DateTimeSelector/DateTimeSelector';\n// import { Redirect } from 'react-router-dom';\nimport Auth from '../../../../utils/Auth';\nimport MultiSelectContainer from '../MultiSelect/MultiSelectContainer';\nimport Timepicker from '../../../../components/TimePicker/TimePicker';\nimport './AddMeds.css'\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport { Redirect } from 'react-router-dom'\n\nconst styles = theme => ({\n  container: {\n    display: 'flex',\n    flexWrap: 'wrap',\n  },\n  submitbutton: {\n    marginTop: 25,\n    height: 10,\n  },\n  textField: {\n    marginLeft: theme.spacing.unit,\n    marginRight: theme.spacing.unit,\n    width: 200,\n  },\n  dense: {\n    marginTop: 19,\n  },\n  menu: {\n    width: 200,\n  },\n});\n\nclass AddMeds extends React.Component {\n  state = {\n    allStudents: [],\n    studentIdsToSubmit: [],\n    time: '',\n    medName: '',\n    multiline: 'Controlled',\n    snackbarMessage: 'No student selected'\n  };\n\n  timepickerState = React.createRef();\n  componentWillMount() {\n    Auth.StaffAuthorize(this);\n  }\n\n  updateStudents = newArray => {\n    this.setState({ allStudents: newArray });\n  };\n  handleSubmit = async event => {\n    event.preventDefault();\n    const time = this.timepickerState.current.returnTime();\n    await this.setState({ time })\n    let idArray = [];\n    this.state.allStudents.map(student => {\n      if (student.selected === true) {\n        idArray.push(student.id);\n      }\n    });\n    await this.setState({ studentIdsToSubmit: idArray });\n    if (this.state.studentIdsToSubmit.length === 0)\n      this.handleClickSnackbar();\n    else this.state.studentIdsToSubmit.map(id => this.postMeds(id));\n  };\n\n  handleChange = name => event => {\n    this.setState({\n      [name]: event.target.value,\n    });\n  };\n\n\n  postMeds = id => {\n    let today = new Date();\n    let date =\n      today.getFullYear() +\n      '-' +\n      (today.getMonth() + 1) +\n      '-' +\n      today.getDate();\n    console.log(date);\n    fetch(`/api/student/${id}/medicine`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        time: this.state.time,\n        medName: this.state.medName,\n        date: date,\n      }),\n    })\n      .then(resp => {\n        console.log(resp);\n        return resp.json();\n      })\n      .then(resp => {\n        console.log(\"Resp2:\", resp)\n        if (resp.errors) {\n          if (resp.errors.length > 0) {\n            if (resp.errors[0].message === \"Validation notEmpty on medName failed\")\n              this.setState({ snackbarMessage: \"Please write medicine name\" }, this.handleClickSnackbar())\n          }\n        } else if (resp) {\n          this.setState({ snackbarMessage: \"Medication added.\" },\n            this.handleClickSnackbar())\n        }\n      });\n  };\n\n  handleClickSnackbar = () => {\n    this.setState({ open: true });\n  };\n  handleCloseSnackbar = (event, reason) => {\n    if (reason === \"clickaway\") {\n      return;\n    }\n    this.setState({ open: false, studentIdsToSubmit: [], snackbarMessage: 'No student selected' });\n  };\n\n  render() {\n    const { classes } = this.props;\n    if (this.state.loggedIn) {\n      return (\n        <div>\n          <HeaderBar type={this.state.userType} />\n          <MultiSelectContainer\n            orgId={this.state.orgId}\n            allStudents={this.state.allStudents}\n            updateStudents={this.updateStudents}\n          />\n\n          <div className=\"addmeds-container\">\n            <div className=\"addmeds-item1\">\n              <Timepicker ref={this.timepickerState} setTime={this.setMedTime} />\n            </div>\n            <div className=\"addmeds-item2\">\n              <TextField\n                required\n                label=\"Medicines Administered\"\n                className={classes.textField}\n                value={this.state.medName}\n                rows='5'\n                onChange={this.handleChange('medName')}\n                multiline\n                margin=\"normal\"\n                variant=\"outlined\"\n              />\n            </div>\n\n            <Button\n              className={classes.submitbutton}\n              color='primary'\n              onClick={this.handleSubmit}\n            >\n              Add Activity\n            </Button>\n          </div>\n          <Snackbar\n            anchorOrigin={{\n              vertical: \"bottom\",\n              horizontal: \"left\"\n            }}\n            open={this.state.open}\n            autoHideDuration={6000}\n            onClose={this.handleCloseSnackbar}\n            ContentProps={{\n              \"aria-describedby\": \"message-id\"\n            }}\n            message={<span id=\"message-id\">{this.state.snackbarMessage}</span>}\n            action={[\n              <IconButton\n                key=\"close\"\n                aria-label=\"Close\"\n                color=\"inherit\"\n                className={classes.close}\n                onClick={this.handleCloseSnackbar}\n              >\n                <CloseIcon />\n              </IconButton>\n            ]}\n          />\n        </div>\n      );\n    } else if (this.state.loginRejected) {\n      return (\n        <Redirect\n          to={{\n            pathname: \"/notAuthorized\",\n            state: {\n              type: \"Staff\",\n              location: '/dailyreport/addmeds'\n            }\n          }}\n        />\n      );\n    } else {\n      return <div />;\n    }\n  }\n}\n\nAddMeds.propTypes = {\n  classes: PropTypes.object.isRequired,\n};\n\nexport default withStyles(styles)(AddMeds);\n"]},"metadata":{},"sourceType":"module"}